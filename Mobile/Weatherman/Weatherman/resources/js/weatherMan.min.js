Bridge.Class.define("WeathermanBuilder.Weatherman",{statics:{$config:{fields:{key:"YOUR KEY HERE",weatherUrl:"http://api.wunderground.com/api/{0}/forecast/geolookup/conditions/q/{1},{2}.json"},init:function(){Bridge.ready(this.main)}},main:function(){WeathermanBuilder.Weatherman.getForecast();$(Bridge.merge(document.createElement("button"),{type:"button",className:"btn btn-primary",innerHTML:'<span class="glyphicon glyphicon-refresh"><\/span>',onclick:WeathermanBuilder.Weatherman.updateButton_Click})).appendTo("#btnDiv")},getForecast:function(){Bridge.global.navigator.geolocation.getCurrentPosition(function(n){WeathermanBuilder.Weatherman.getWeather(n.coords.latitude,n.coords.longitude)})},getWeather:function(n,t){$.getJSON(Bridge.String.format(WeathermanBuilder.Weatherman.weatherUrl,WeathermanBuilder.Weatherman.key,n,t),null,function(n){var t=$("input[type='radio'][name='metric']:checked"),i=t.length>0?t.val():"c",r=n.location.city,u=n.current_observation["temp_"+i],f=n.current_observation.icon_url,e=n.current_observation.weather,o=n.current_observation.wind_string;$("#location").html(r.toString());$("#temp").html(u.toString());$("#desc").html(e.toString());$("#wind").html(o.toString());$("#img").attr("src",f.toString());$("#"+i).attr("checked","checked").parent().addClass("active")}).fail(function(){Bridge.global.alert("Key required to call the Weather Underground API not found.")})},updateButton_Click:function(){WeathermanBuilder.Weatherman.getForecast()}}})